sudo: required
language: go
services:
  - docker

script:
  - docker build -t homie-controller:build-$TRAVIS_COMMIT -f Dockerfile.build . ;
  - docker run homie-controller:build /usr/local/bin/get-artifact > homie-controller;
  - docker build -t jbonachera/homie-controller:$TRAVIS_COMMIT . ;
after_success:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
  - docker push jbonachera/homie-controller:$TRAVIS_COMMIT;
